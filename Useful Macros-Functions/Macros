## Updating ThinkCell Charts in PowerPoint: (https://www.think-cell.com/en/support/manual/exceldataautomation.shtml)

Sub UpdateThinkCell()

   Dim graph As Range    
   Dim tcaddin As Object                                                'Get the think-cell add-in object
   Dim ppapp As Object
   Dim pres As PowerPoint.Presentation
   
   Set graph = ActiveWorkbook.Sheets("Think Cell").Range("D3:L6")       'Select Range that belongs to Graph associated with Think-Cell                                                                                                          
   Set tcaddin = Application.COMAddIns("thinkcell.addin").Object
   Set ppapp = New PowerPoint.Application
 
   Set pres = ppapp.Presentations.Open( _                               'Set location of PowerPoint Document
     Filename:="C:\Users\"your link to PowerPoint file", _
      Untitled:=msoTrue)
 
   Call tcaddin.UpdateChart(pres, "myChart", week10, _                  'Call the ThinkCell Graph by using the Chart Name "myChart" in this case 
    False)
  
   pres.SaveAs ("C:\Users\mathieu.cloutier\Desktop\Coutu\Bell Weekly SP\BUS SP_Weekly Updated.pptx")    'Save the updated presentation
   pres.Close
   
   ppapp.Quit
   
   If Err = 0 Then MsgBox "Excel and PowerPoint has been updated"       'Msg box saying that the reports have been updated 
   
End Sub


## Updating OLAP cubes based on Dates in a specified range

Sub UpdateOLAPcube()

ActiveSheet.PivotTables("Name of Pivot Table").PivotFields( _     
"[dim DateTime].[Year-Week-Day].[Calendar Year]").VisibleItemsList = Array("")            'Alter based on criteria, in this case it was for filtering dates

ActiveSheet.PivotTables("Name of Pivot Table").PivotFields( _
        "[dim DateTime].[Year-Week-Day].[Calendar Week]").VisibleItemsList = Array( _
        "[dim DateTime].[Year-Week-Day].[Calendar Week].&[2018]&[" & Range("Q4").Value & "]", _
        "[dim DateTime].[Year-Week-Day].[Calendar Week].&[2018]&[" & Range("Q5").Value & "]", _
        "[dim DateTime].[Year-Week-Day].[Calendar Week].&[2018]&[" & Range("Q6").Value & "]")      'Date ranges are in Q4,Q5,Q5. These dates are being selected in the OLAP cube
Cells(1, 1).Select     'Selecting nothing 

End Sub



## Selecting Tabular data using VBA ( References : Microsoft HTML Object Library, Microsoft Internet Controls)

    Dim IE As New InternetExplorer, html As HTMLDocument
    Dim post, elem, trow As Object
    Dim c, r As Integer
    Dim Today As Date
    Dim ws As Worksheet

    Today = Date
    
    Range("A2:Z100").ClearContents
    
    With IE
        .Visible = False
        .navigate "http://rrt2.int.bell.ca/WFM_Adhoc_Engine/?rep=79&isAL=-1&isPL=1&isPossiblePL=-1&Prov=QUEBEC&sdate=" & Today & "&endDate=" & Today & "&luminexxiel=sugoi&Channel=2;3"
        While .readyState < 4: DoEvents: Wend
        Set html = .document
    End With

    Application.Wait Now + TimeValue("00:00:05") 'this is the trick here to get the data

    Set post = html.getElementById("TablixMainTable")

    For Each elem In post.Rows
        For Each trow In elem.Cells
            c = c + 1: Worksheets("PL_Data").Cells(r + 2, c) = trow.innerText
        Next trow
        c = 0
        r = r + 1
    Next elem
    IE.Quit
    
   




